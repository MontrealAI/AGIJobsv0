<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AGI Jobs — One‑Box</title>
    <meta
      name="description"
      content="Single-box interface for orchestrating AGI Jobs workflows with walletless and expert modes."
    />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; base-uri 'none'; connect-src {{ connect_src }}; font-src 'self'; form-action 'self'; frame-ancestors 'self'; img-src 'self' data:; object-src 'none'; script-src 'self'; style-src 'self'; upgrade-insecure-requests"
    />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='24' fill='%2308121f'/%3E%3Ctext x='50' y='64' font-family='Inter,Arial,sans-serif' font-size='52' fill='%23f8fafc' text-anchor='middle'%3EA%3C/text%3E%3C/svg%3E" />
    <link
      rel="stylesheet"
      href="{{ styles_css_href }}"
      integrity="{{ styles_css_integrity }}"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="wrap">
      <header class="header">
        <div class="header-title">
          <h1>AGI Jobs — One‑Box</h1>
          <p class="header-subtitle">Conversational command of institutional-grade on-chain labour.</p>
        </div>
        <div class="header-badges">
          <span class="badge" id="mode">Mode: Guest (walletless)</span>
          <span class="badge">Ask → Confirm → Done + Receipt</span>
        </div>
      </header>

      <section class="hero">
        <div class="hero-card">
          <h2>Launch a mission in three lines of chat</h2>
          <p>
            Describe your outcome, confirm the plan, and we do the rest — staking, escrow, IPFS logistics, and on-chain audit
            trails happen automatically.
          </p>
          <ul class="hero-points">
            <li><strong>Wallet optional.</strong> Relayer handles gas and escrow while respecting your policy caps.</li>
            <li><strong>Owner-first.</strong> Pause, retune fees, and rotate keys in seconds via the standard control scripts.</li>
            <li><strong>Proof on arrival.</strong> Every step yields signed receipts with explorer links and CID anchors.</li>
          </ul>
        </div>
        <aside class="hero-status">
          <div class="status-chip">Real-time planner ↔ simulator ↔ executor telemetry</div>
          <dl>
            <div>
              <dt>Planner latency (avg)</dt>
              <dd id="stat-planner">—</dd>
            </div>
            <div>
              <dt>Simulation guardrails</dt>
              <dd id="stat-guardrails">Budget, burn, risk, pause</dd>
            </div>
            <div>
              <dt>Relayer</dt>
              <dd id="stat-relayer">Policy limited, auditable</dd>
            </div>
          </dl>
        </aside>
      </section>

      <section class="chat-shell">
        <div id="chat" class="chat-history" role="log" aria-live="polite">
          <div class="msg m-assist">Ask → Confirm → Done + Receipt.</div>
        </div>
        <form id="onebox-form" class="chat-form">
          <label for="onebox-input">Describe what you need done</label>
          <div class="chat-input-row">
            <textarea
              id="onebox-input"
              placeholder="Describe what you need done… e.g. Label 500 images, 5 AGIALPHA, 7 days"
            ></textarea>
            <button type="submit" class="primary-btn" id="send">Send</button>
            <button type="button" class="ghost-btn" id="expert" title="Toggle Expert Mode (wallet signing)">
              Expert Mode
            </button>
          </div>
        </form>
      </section>

      <section class="sec">
        <h2>Shortcuts</h2>
        <div class="pill-row">
          <button class="pill" type="button" data-example="Post a research job, 3 AGIALPHA, 5 days">Research job</button>
          <button class="pill" type="button" data-example="Finalize job 123">Finalize job</button>
          <button class="pill" type="button" data-example="Status of job 123">Status check</button>
        </div>
        <span class="note"
          >Walletless by default. Expert mode prepares calldata for your wallet via <span class="kbd">eth_sendTransaction</span>.
        </span>
      </section>

      <aside class="sidebar">
        <details id="expert-panel" class="sec expert-panel" hidden>
          <summary>Expert Details</summary>
          <div class="expert-panel-content">
            <div class="expert-meta">
              <div>
                <span class="expert-label">Network</span>
                <span id="expert-network" class="expert-value">—</span>
              </div>
              <div>
                <span class="expert-label">Contract</span>
                <span id="expert-contract" class="expert-value">—</span>
              </div>
            </div>
            <div class="expert-json-block">
              <span class="expert-label">Latest Plan Response</span>
              <pre id="expert-plan-json" class="expert-json">No plan response yet.</pre>
            </div>
            <div class="expert-json-block">
              <span class="expert-label">Last Execute Request</span>
              <pre id="expert-execute-request" class="expert-json">No execute request yet.</pre>
            </div>
            <div class="expert-json-block">
              <span class="expert-label">Last Execute Response</span>
              <pre id="expert-execute-response" class="expert-json">No execute response yet.</pre>
            </div>
          </div>
        </details>

        <section class="sec">
          <h2>Advanced</h2>
          <label>
            Orchestrator URL
            <input id="orch" type="text" placeholder="https://your-orchestrator.example" />
          </label>
          <label>
            Orchestrator prefix
            <input id="orch-prefix" type="text" placeholder="/onebox" />
          </label>
          <label>
            API Token
            <input id="tok" type="text" placeholder="(Bearer token)" />
          </label>
          <div class="sec-actions">
            <button type="button" class="ghost-btn" id="save">Save</button>
            <button type="button" class="ghost-btn" id="connect">Connect Wallet</button>
            <button type="button" class="ghost-btn" id="clear-receipts">Clear Receipts</button>
          </div>
          <span class="note">No hashes or gas pop-ups for end users. Confirmations stay under 140 characters.</span>
        </section>

        <section class="sec">
          <h2>Receipts</h2>
          <div id="receipts-empty" class="receipt-empty">No receipts yet — run a job to see the audit trail.</div>
          <ul id="receipts-list" class="receipt-list"></ul>
        </section>
      </aside>
    </div>

    <noscript>
      <p class="note">JavaScript is required for the AGI Jobs one-box interface.</p>
    </noscript>

    <script
      type="module"
      src="{{ app_js_src }}"
      integrity="{{ app_js_integrity }}"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
