type ProtocolStats @entity {
  id: ID!
  totalJobs: Int!
  openJobs: Int!
  finalizedJobs: Int!
  totalEscrowed: BigInt!
  totalStaked: BigInt!
  totalSlashed: BigInt!
  totalValidatorVotes: Int!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
}

type Job @entity {
  id: ID!
  jobId: BigInt!
  employer: Bytes!
  createdAtBlock: BigInt!
  createdAtTimestamp: BigInt!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
  finalizedAtBlock: BigInt
  finalizedAtTimestamp: BigInt
  reward: BigInt!
  stake: BigInt!
  fee: BigInt!
  escrowed: BigInt!
  state: String!
  assignedTo: Bytes
  validatorQuorum: Int!
  approvals: Int!
  rejections: Int!
  uri: String
  specHash: Bytes
  domain: Domain
  domainKey: Bytes
  votes: [ValidatorVote!]! @derivedFrom(field: "job")
}

type Domain @entity {
  id: ID!
  slug: String!
  name: String!
  metadataURI: String
  credentialSchema: Bytes
  l2Network: Bytes
  dispatcher: Bytes
  oracle: Bytes
  bridge: Bytes
  l2Gateway: Bytes
  minStake: BigInt!
  resilienceFloor: Int!
  maxConcurrentJobs: Int!
  requiresHumanReview: Boolean!
  active: Boolean!
  paused: Boolean!
  createdAtBlock: BigInt!
  createdAtTimestamp: BigInt!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
  jobs: [Job!]! @derivedFrom(field: "domain")
  metric: DomainMetric
}

type DomainMetric @entity {
  id: ID!
  domain: Domain!
  totalJobs: Int!
  activeJobs: Int!
  resilienceFloor: Int!
  requiresHumanReview: Boolean!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
}

type DomainRegistryState @entity {
  id: ID!
  paused: Boolean!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
}

type Stake @entity {
  id: ID!
  user: Bytes!
  role: String!
  currentBalance: BigInt!
  totalDeposited: BigInt!
  totalSlashed: BigInt!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
}

type StakeAggregate @entity {
  id: ID!
  role: String!
  currentBalance: BigInt!
  totalDeposited: BigInt!
  totalSlashed: BigInt!
  participantCount: Int!
  updatedAtBlock: BigInt!
  updatedAtTimestamp: BigInt!
}

type Validator @entity {
  id: ID!
  address: Bytes!
  totalVotes: Int!
  totalApprovals: Int!
  totalRejections: Int!
  lastVotedAtBlock: BigInt
  lastVotedAtTimestamp: BigInt
  stake: Stake
  votes: [ValidatorVote!]! @derivedFrom(field: "validator")
}

type ValidatorVote @entity {
  id: ID!
  job: Job!
  validator: Validator!
  approved: Boolean!
  burnTxHash: Bytes
  txHash: Bytes!
  logIndex: BigInt!
  revealedAtBlock: BigInt!
  revealedAtTimestamp: BigInt!
}
