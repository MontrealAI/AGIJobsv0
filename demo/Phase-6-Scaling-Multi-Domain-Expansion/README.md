# Phase 6 — Scaling & Multi-Domain Expansion Demo

> **Mission**: prove to a non-technical operator that AGI Jobs v0/v2 can be the command console for civilization-scale autonomy. This demo couples smart-contract level controls, cross-domain agent routing, subgraph telemetry, and Layer-2 deployment plans into a single, copy-paste friendly experience.

---

## 🌐 Why this demo matters

* **Instant global expansion** – governance can register, pause, or rewire entire industry stacks with a single `Phase6ExpansionManager` transaction.
* **Non-technical empowerment** – a single command (`npm run demo:phase6:orchestrate`) emits pre-validated calldata, bridge plans, and AI orchestration summaries.
* **Planetary telemetry** – the subgraph now indexes `Phase6Domain` & `Phase6GlobalConfig`, letting dashboards stream readiness, resilience indices, and upgrade intents in real time.
* **Bullet-proof governance** – every parameter is updatable by the contract owner (timelock/multisig) including emergency pause delegates and cross-chain bridges.
* **CI as a guardian** – the `ci (v2) / Phase 6 readiness` job enforces configuration drift detection on every PR and on `main`.

---

## 🧭 Quickstart (non-technical operator)

1. **Install dependencies** (once):
   ```bash
   npm ci
   ```
2. **Generate Phase 6 runbook & calldata**:
   ```bash
   npm run demo:phase6:orchestrate
   ```
   This prints:
   * Domain IDs and encoded `registerDomain` / `updateDomain` payloads.
   * Layer-2 bridge plans synthesized from the config and the on-chain ABI.
   * A ready-to-copy mermaid system diagram and runtime routing commentary from the Python orchestrator.
3. **Verify readiness in CI** (runs automatically, can be triggered locally):
   ```bash
   npm run demo:phase6:ci
   ```
   The script validates JSON schema, address hygiene, ABI sync, and UI artifacts before the CI job signs off.
4. **Open the control surface UI**:
   *Serve locally or open directly in the repo*
   ```bash
   npx serve demo/Phase-6-Scaling-Multi-Domain-Expansion
   ```
   Navigate to `http://localhost:3000` (default). The page renders interactive domain cards, live bridge plans, and a mermaid map.

---

## 🧱 Smart contract authority

`contracts/v2/Phase6ExpansionManager.sol` introduces a governance-only control plane that keeps the owner in absolute command:

* `registerDomain`, `updateDomain`, `configureDomainConnectors`, `setDomainStatus`
* `setGlobalConfig`, `setSystemPause`, `setEscalationBridge`, `forwardPauseCall`, `forwardEscalation`
* Deterministic `domainId` helper & `listDomains()` enumeration for tooling.

Emergency response: governance can forward any encoded call to the shared `SystemPause` contract or to an arbitrary escalation bridge. Pausing, routing, and redeployments remain one-click actions for the owner.

---

## 🧠 Agent runtime extension

`orchestrator/extensions/phase6.py` + the runtime hook inside `StepExecutor` bring Phase 6 awareness to every orchestration step:

```mermaid
flowchart TD
  Intent[User intent / IoT signal] --> Runtime[Phase6Runtime]
  Runtime -->|scores domains, merges global manifest| Domain[Selected domain profile]
  Domain --> Executor[StepExecutor]
  Executor --> BridgePlan[Bridge & oracle plan]
  Executor --> Logs[Annotated run log \n(heartbeat, routers, DID checks)]
```

* Reads the JSON snapshot generated by this demo (`config/domains.phase6.json`) or a subgraph export.
* Scores domains by skill tags, capability weights, and governance priority.
* Annotates every orchestration log with manifest URIs, heartbeat cadences, IoT routers, and execution routers.
* Provides `build_bridge_plan` & `ingest_iot_signal` helpers for Layer-2 routing and IoT-triggered job creation.

---

## 🛰️ Subgraph telemetry upgrades

The Graph mapping indexes the new events so dashboards, analytics, and governance tooling have live insight:

* `Phase6Domain` entity tracks metadata, routing addresses, heartbeat SLAs, and pause status.
* `Phase6GlobalConfig` entity exposes the canonical IoT router, L2 cadence, DID registry, and manifest URI.
* Each event (`DomainRegistered`, `DomainUpdated`, `DomainStatusChanged`, `GlobalConfigUpdated`) updates the store instantly.

These additions power UI cards, CI validation, and off-chain monitoring (e.g., the Resilience Index).

---

## 🔁 CI enforcement

A new job in `.github/workflows/ci.yml` named **Phase 6 readiness** runs on every PR/main push:

1. Installs dependencies (cached).
2. Validates the Phase 6 domain manifest via `npm run demo:phase6:ci`.
3. Asserts the mermaid UI, ABI files, and config schema stay in sync.
4. Publishes a short status summary to the GitHub Checks UI.

`EXPECTED_CONTEXTS` in `scripts/ci/verify-branch-protection.ts` is updated so branch protection refuses merges without this signal.

---

## 🖥️ Demo UI snapshot

![Phase 6 control surface](./index.html)

Open `index.html` to explore:

* Dynamic domain cards with L2 cadence, oracle routes, and skill matrices.
* Embedded mermaid system map.
* Copyable calldata panes (auto-updated from the JSON config).
* “One-click ready” states for finance, health, logistics, climate, plus global manifest metadata.

---

## 🛠️ Customising your rollout

1. **Edit** `config/domains.phase6.json` – tweak addresses, manifests, skills, or heartbeat cadences.
2. **Regenerate** plans with `npm run demo:phase6:orchestrate` (no build step needed).
3. **Commit** the change. CI will block if a field is missing or malformed.
4. **Ship** – governance can copy the calldata into a multi-sig, or run through the existing owner scripts.

> Tip: pair this demo with `npm run owner:mission-control` to script the actual transaction bundle from the same console.

---

## ✅ Deliverables included

* Smart-contract upgrade: `Phase6ExpansionManager` + tests + mocks.
* Python runtime extension with domain routing, IoT signal ingestion, and bridge planning.
* Subgraph schema & mapping updates for Phase 6 telemetry.
* Static UI + JSON config + orchestration scripts for non-technical operators.
* CI guardrail + branch-protection expectation updates.

Welcome to Phase 6.
