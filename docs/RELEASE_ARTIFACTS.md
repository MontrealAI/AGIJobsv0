# AGI Jobs v2 — Release Artefact Inventory & Verification Evidence

> **Scope:** Reference for operators, auditors, and reviewers who need to consume the `release` workflow outputs. This document maps every published artefact to its purpose, verification steps, and reproducibility checks so that institutional stakeholders can independently attest to build provenance.

---

## 1. Source of truth

The [`release`](../.github/workflows/release.yml) workflow is the canonical pipeline for producing deployable packages. It is triggered for semver tags (`v*`) or via manual dispatch. The workflow performs:

1. Deterministic contract compilation (`npx hardhat compile`) and ABI/typechain packaging.
2. Manifest generation (`reports/release/manifest.json`) that captures addresses, bytecode hashes, toolchain versions, and git metadata.
3. SBOM creation (`reports/sbom/cyclonedx.json`) alongside build provenance attestation (Sigstore + SLSA compliant).
4. Automated on-chain explorer verification using `scripts/release/run-etherscan-verification.js` with OIDC-sourced API credentials.
5. Container image builds, Trivy scans, cosign signatures, and digest publication for every production runtime.

The workflow blocks release publication unless the verification job and container scans succeed, ensuring all security gates remain enforced on `main` and tags.

---

## 2. Artefact bundle contents

The GitHub Release named `AGI Jobs vX.Y.Z` publishes a signed tarball and associated digests/signatures. Expanding the tarball yields the directories below:

| Path | Description | Verification / Usage |
| --- | --- | --- |
| `reports/release/manifest.json` | Canonical deployment manifest enumerating every contract, address source, ABI hash, and bytecode hash. | Compare `bytecodeHash` against explorer bytecode; confirm `git.commit`, `toolchain` and `network` metadata for reproducibility. |
| `reports/release/verification-summary.json` | Machine-readable log of the automated explorer verification run. | Validate that each contract status is `verified` or `already_verified`. Provides the address, fully-qualified contract name, and the API key source used for verification. |
| `reports/release/notes.md` | Generated release notes used as the GitHub Release body. | Contains human-readable summary, contract table, warnings, and checklist. |
| `reports/sbom/` | CycloneDX SBOM + derived reports. | Import into dependency scanners; cross-check supply-chain attestations. |
| `reports/abis/head/` | ABI exports aligned with `manifest.json`. | Hand to integrators, front-ends, or monitoring systems. |
| `typechain-types/` | TypeChain bindings for the above ABIs. | Enables typed interaction in Node/TypeScript runtimes. |
| `deployment-config/` | Deployment configurations and explorer verification inputs. | Use when re-running verification or reproducing deployments locally. |

All files are packaged into `dist/agi-jobs-vX.Y.Z-artifacts.tar.gz`, accompanied by:

- `dist/agi-jobs-vX.Y.Z-artifacts.tar.gz.sha256`
- `dist/agi-jobs-vX.Y.Z-artifacts.tar.gz.sig`
- `dist/agi-jobs-vX.Y.Z-artifacts.tar.gz.pem`

These allow anyone to validate integrity via `sha256sum -c` and `cosign verify-blob --cert ... --signature ...`.

---

## 3. Standalone release assets

Beyond the tarball, the release publishes additional files for convenience:

- `release-prep/reports/release/verification-summary.json` — same content as within the tarball, exposed separately for quick inspection or downstream automation.
- `${{ matrix.name }}-release-digest` artefacts — per-image digests emitted by the container publishing matrix.
- Sigstore/SLSA provenance bundle generated by `actions/attest-build-provenance`.

Each container image pushed to GHCR is cosign-signed (keyless) and scanned with Trivy for HIGH/CRITICAL CVEs prior to release asset publication.

---

## 4. Operational checklist for consumers

| Step | Action |
| --- | --- |
| 1 | Download `agi-jobs-vX.Y.Z-artifacts.tar.gz` and verify the `.sha256` checksum. |
| 2 | Verify the cosign signature using the attached `.sig` and `.pem` (OIDC certificate). |
| 3 | Extract the archive and inspect `reports/release/verification-summary.json` to confirm explorer verification succeeded. |
| 4 | Cross-check `reports/release/manifest.json` against live explorer data (addresses, bytecode hashes). |
| 5 | Import `reports/sbom/cyclonedx.json` into your dependency scanning tooling for supply-chain attestation. |
| 6 | Update `docs/DEPLOYED_ADDRESSES.md` and internal runbooks with the manifest data (owner, treasury, pauser configurations). |

Following this checklist provides provable evidence that the deployed contracts map 1:1 with the audited repository state and that administrative controls remain under the designated owner multi-sig.

---

## 5. Troubleshooting & escalation

- **Verification summary missing?** The release workflow now halts the GitHub Release publication until the `Verify deployed contracts` job completes. If an explorer outage occurs, re-run the workflow with `--dry-run` to generate artefacts without publishing, then re-execute when the explorer stabilises.
- **Cosign or provenance validation fails?** Confirm system trust stores include Fulcio's root certificates. For air-gapped reviews, download the `.pem` certificate and validate against the transparency log entry.
- **Need manual verification?** Use `npm run release:verify -- --network <network> --dry-run` with appropriate environment variables to reproduce the explorer calls locally.

---

Maintaining this release discipline keeps AGI Jobs v2 aligned with institutional expectations: auditable provenance, deterministic builds, automated verification, and full operator visibility into every published artefact.
